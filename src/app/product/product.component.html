<div class="container">
  <div class="row">
    <div class="col-8">
      <div class="m-3">
        <div class="bg-info text-white m-2 p-2">
          {{ jsonProduct }}
        </div>
        <form #form="ngForm" (ngSubmit)="submitForm(form)">
          <div
            class="bg-danger text-white p-3 my-2 rounded"
            *ngIf="formSubmitted && form.invalid"
          >
            An error has ocurred. Check your info.
            <ul>
              <li *ngFor="let error of getFormErrors(form)">
                {{ error }}
              </li>
            </ul>
          </div>
          <div class="form-group">
            <label for="">ID</label>
            <input
              required
              type="text"
              class="form-control"
              [(ngModel)]="newProduct.id"
              #id="ngModel"
              name="id"
            />
            <div class="alert alert-danger" *ngIf="id.touched && !id.valid">
              ID is required
            </div>
          </div>
          <div class="form-group">
            <label for="">Name</label>
            <input
              required
              minlength="3"
              pattern="^[A-Za-z]+$"
              name="name"
              #name="ngModel"
              type="text"
              class="form-control"
              [(ngModel)]="newProduct.name"
            />
            <ul
              class="alert alert-danger"
              *ngIf="(formSubmitted || name.dirty) && name.invalid"
            >
              <li *ngFor="let error of getValidationErrors(name, name.name)">
                {{ error }}
              </li>
            </ul>
          </div>
          <div class="form-group">
            <label for="">Price</label>
            <input
              required
              #pPrice="ngModel"
              type="number"
              class="form-control"
              [(ngModel)]="newProduct.price"
              name="price"
              [class.ng-invalid]="pPrice.value <= 0"
              [class.ng-valid]="pPrice.value > 0"
            />
            <div *ngIf="pPrice.touched">
              <p class="alert alert-danger" *ngIf="!pPrice.valid">
                <span *ngIf="pPrice.errors['required']"></span>
                Price is required
              </p>
              <p class="alert alert-danger" *ngIf="pPrice.value <= 0">Price must be positive value</p>
            </div>
          </div>
          <div class="form-group">
            <label for="">Description</label>
            <textarea
              name=""
              id=""
              cols="30"
              rows="2"
              class="form-control"
              #desc="ngModel"
              [(ngModel)]="newProduct.description"
              name="desc"
            ></textarea>
            <div class="alert alert-danger" *ngIf="desc.touched && !desc.valid">
              Name is required
            </div>
          </div>
          <div class="form-group">
            <label for="">Image Url</label>
            <input
              required
              type="text"
              class="form-control"
              #image="ngModel"
              [(ngModel)]="newProduct.imageUrl"
              name="image"
            />
            <div
              class="alert alert-danger"
              *ngIf="image.touched && !image.valid"
            >
              Image is required
            </div>
          </div>

          <button
            type="submit"
            class="btn btn-primary mt-3"
            (click)="addProduct(newProduct)"
            [disabled]="formSubmitted && form.invalid"
            [class.btn-secondary]="formSubmitted && form.invalid"
          >
            Submit
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
